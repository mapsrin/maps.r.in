---
output: html_document
---

<style>
    body .main-container {
        max-width: 100%;
        padding: 0;
        margin: 0;
    }
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, echo=FALSE, message=F, warning=F, results = 'hide'}
library("leaflet")
library("rgdal")
library("rvest")
library("ggmap")
library("raster")
library("sp")
library("htmlwidgets")

states <- readOGR("data/IndiaAdminUnits/States.shp")

url <- 'https://en.wikipedia.org/wiki/List_of_states_and_union_territories_of_India_by_sex_ratio'
ratio <- url %>%
  read_html() %>%
  html_nodes(xpath = '//*[@id="mw-content-text"]/div/table[2]') %>%
  html_table()
ratio <- ratio[[1]]#[-1,]
ratio[[1]] <- NULL
head(ratio)

colourIndex = c(1,1,1,2,2,3,2,3,1,3,2,2,3,2,3,2,1,1,3,1,1,1,3,3,3,2,1,4,2,3,3,1,1,4,1,4)
areas <- c(8249, 162968, 83743, 78438, 94163, 114, 135191, 491, 112, 3702, 196024, 44212, 55673, 222236, 79714, 191791, 38863, 32, 308350, 307713, 22327, 22429, 21081, 16579, 1484, 562, 50362, 342239, 7096, 130058, 112077, 10486, 243290, 53483, 88752, 155707)
states[["Area"]] <- areas
colors4 <- c("#3300FF", "#CCFF00", "#00B3FF", "#FF0000")

states[["ColourIndex"]] <- colourIndex
```

## {.tabset}
### States of India

```{r, echo=FALSE, warning=F}
map <- leaflet(width = "100%") %>% 
  addProviderTiles("Esri") %>% 
  addPolygons(data = states, 
              color = "#000000", 
              weight = 1, smoothFactor = 0.5,
              opacity = 1.0, fillOpacity = 0.5,
              dashArray = "3",
              fillColor = colors4[states$ColourIndex],
              label = ~states$ST_NM,
              highlightOptions = highlightOptions(color = "white", weight = 2),
              popup = paste0("<strong>State name: </strong>",
                             states$ST_NM, 
                             "<br><strong>Area in square km: </strong>",
                             states$Area)) %>%
  addMiniMap(tiles = providers$Esri, toggleDisplay = TRUE) %>% 
  addScaleBar() %>%
  addSimpleGraticule(showOriginLabel = TRUE)
map
```

### Data

```{r}
library(DT)
datatable(states@data, options = list(pageLength = 100))
```

### Info

Shape files from:
Demo of 4 colour theorem