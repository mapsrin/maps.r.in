---
output: html_document
---

<style>
    body .main-container {
        max-width: 100%;
        padding: 0;
        margin: 0;
    }
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, echo=FALSE, message=F, warning=F, results = 'hide'}
library(leaflet)
library(rgdal)
library(ggmap)
library(raster)
library(sp)
library(htmlwidgets)
library(htmltools) 

states <- readOGR("data/IndiaAdminUnits/States.shp", stringsAsFactors = FALSE)
states <- states[order(states$State.Name),]

colourIndex = c(2,4,3,4,1,1,1,1,1,3,3,2,4,3,4,4,1,4,1,1,3,4,2,3,3,1,3,1,2,1,3,2,2,1,2,1,2,5)

#Source: https://en.wikipedia.org/wiki/List_of_states_and_union_territories_of_India_by_area
areas <- c("8,249", "162,970", "83,743", "78,438", "94,165", "114", "135,191", "491", "112", "1,483", "3,702", "196,024", "44,212", "55,673", "42,241", "79,714", "191,791", "38,863", "59,146", "32", "308,350", "307,713", "22,327", "22,429", "21,081", "16,579", "155,707", "492", "50,362", "342,238", "7,096", "130,058", "112,077", "10,486", "243,290", "53,483", "88,752", NA)
states[["Area (sqkm)"]] <- areas
colors4 <- c("#3300FF", "#CCFF00", "#00B3FF", "#FF0000", "#999999")

```

## {.tabset}
### States and Union Territories of India*

```{r, echo=FALSE, warning=F}

labelsInfo <- lapply(seq(nrow(states@data)), function(i) {
  if(i<38) {
    paste0( '<p>', sprintf(
       "<div style='width:95%%'>
        <div style='font-size:12px;width:200px;float:left'>
        <span style='font-size:12px;font-weight:bold'>%s</span><hr>
        <span style='float:left'>Area : %s (sqkm)</span><br/>
        <span style='float:left'>Type : %s </span><br/>
        </div>
        </div>",
        states@data[i, "State.Name"],
        states@data[i, "Area (sqkm)"],
        states@data[i, "TYPE"])
      , '</p>' )
  }
})

map <- leaflet(width = "100%") %>% 
  addProviderTiles("Esri") %>% 
  addPolygons(data = states, 
              color = "#000000", 
              weight = 1, smoothFactor = 0.5,
              opacity = 1.0, fillOpacity = 0.5,
              dashArray = "3",
              fillColor = colors4[colourIndex],
              label = lapply(labelsInfo, htmltools::HTML),
              highlightOptions = highlightOptions(color = "white", weight = 2)) %>%
  addMiniMap(tiles = providers$Esri, toggleDisplay = TRUE) %>% 
  addScaleBar() %>%
  addSimpleGraticule(showOriginLabel = TRUE)
map
```
*As of August 2019

### Data

```{r}
#Here Column indices start from 0 !#$$!@#
library(DT)
datatable(states@data, rownames = FALSE, options = list(pageLength = 38, columnDefs = list(list(className = 'dt-right', targets = 2))))
```

### Info

Shape files from:
Demo of 4 colour theorem